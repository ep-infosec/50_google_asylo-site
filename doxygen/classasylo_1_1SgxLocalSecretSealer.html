<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asylo: asylo::SgxLocalSecretSealer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="/favicons/favicon.ico" rel="shortcut icon" type="image/x-icon"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asylo
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceasylo.html">asylo</a></li><li class="navelem"><a class="el" href="classasylo_1_1SgxLocalSecretSealer.html">SgxLocalSecretSealer</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classasylo_1_1SgxLocalSecretSealer-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">asylo::SgxLocalSecretSealer Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>An implementation of the <a class="el" href="classasylo_1_1SecretSealer.html">SecretSealer</a> abstract interface that binds the secrets to the enclave identity on a local machine.  
 <a href="classasylo_1_1SgxLocalSecretSealer.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="sgx__local__secret__sealer_8h_source.html">sgx_local_secret_sealer.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for asylo::SgxLocalSecretSealer:</div>
<div class="dyncontent">
<div class="center"><img src="classasylo_1_1SgxLocalSecretSealer__inherit__graph.png" border="0" usemap="#asylo_1_1SgxLocalSecretSealer_inherit__map" alt="Inheritance graph"/></div>
<map name="asylo_1_1SgxLocalSecretSealer_inherit__map" id="asylo_1_1SgxLocalSecretSealer_inherit__map">
<area shape="rect" id="node2" href="classasylo_1_1SecretSealer.html" title="asylo::SecretSealer" alt="" coords="35,5,181,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for asylo::SgxLocalSecretSealer:</div>
<div class="dyncontent">
<div class="center"><img src="classasylo_1_1SgxLocalSecretSealer__coll__graph.png" border="0" usemap="#asylo_1_1SgxLocalSecretSealer_coll__map" alt="Collaboration graph"/></div>
<map name="asylo_1_1SgxLocalSecretSealer_coll__map" id="asylo_1_1SgxLocalSecretSealer_coll__map">
<area shape="rect" id="node2" href="classasylo_1_1SecretSealer.html" title="asylo::SecretSealer" alt="" coords="35,5,181,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a0dd8aebad2e1411dc0fffed22d6d0eaf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classasylo_1_1SgxLocalSecretSealer.html#a0dd8aebad2e1411dc0fffed22d6d0eaf">SgxLocalSecretSealer</a> (const <a class="el" href="classasylo_1_1SgxLocalSecretSealer.html">SgxLocalSecretSealer</a> &amp;other)=delete</td></tr>
<tr class="separator:a0dd8aebad2e1411dc0fffed22d6d0eaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab80397d0b60ff6f1f59fd8fd34a52b75"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classasylo_1_1SgxLocalSecretSealer.html#ab80397d0b60ff6f1f59fd8fd34a52b75">~SgxLocalSecretSealer</a> ()=default</td></tr>
<tr class="separator:ab80397d0b60ff6f1f59fd8fd34a52b75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9ef3bdad50e42e6ae606df39bc0b9f6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classasylo_1_1SgxLocalSecretSealer.html">SgxLocalSecretSealer</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classasylo_1_1SgxLocalSecretSealer.html#ae9ef3bdad50e42e6ae606df39bc0b9f6">operator=</a> (const <a class="el" href="classasylo_1_1SgxLocalSecretSealer.html">SgxLocalSecretSealer</a> &amp;other)=delete</td></tr>
<tr class="separator:ae9ef3bdad50e42e6ae606df39bc0b9f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2baa820e5057547420bbdab9ff047888"><td class="memItemLeft" align="right" valign="top">SealingRootType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classasylo_1_1SgxLocalSecretSealer.html#a2baa820e5057547420bbdab9ff047888">RootType</a> () const override</td></tr>
<tr class="memdesc:a2baa820e5057547420bbdab9ff047888"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the sealing root type of this <a class="el" href="classasylo_1_1SecretSealer.html">SecretSealer</a>.  <a href="#a2baa820e5057547420bbdab9ff047888">More...</a><br /></td></tr>
<tr class="separator:a2baa820e5057547420bbdab9ff047888"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dcb1ac9d3c53e53c5dfcd0204fffde2"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classasylo_1_1SgxLocalSecretSealer.html#a4dcb1ac9d3c53e53c5dfcd0204fffde2">RootName</a> () const override</td></tr>
<tr class="memdesc:a4dcb1ac9d3c53e53c5dfcd0204fffde2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the sealing root name of this <a class="el" href="classasylo_1_1SecretSealer.html">SecretSealer</a>.  <a href="#a4dcb1ac9d3c53e53c5dfcd0204fffde2">More...</a><br /></td></tr>
<tr class="separator:a4dcb1ac9d3c53e53c5dfcd0204fffde2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a091da2adb1f78dce5ebed12f3c9667b4"><td class="memItemLeft" align="right" valign="top">std::vector&lt; EnclaveIdentityExpectation &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classasylo_1_1SgxLocalSecretSealer.html#a091da2adb1f78dce5ebed12f3c9667b4">RootAcl</a> () const override</td></tr>
<tr class="memdesc:a091da2adb1f78dce5ebed12f3c9667b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the sealing root ACL of this <a class="el" href="classasylo_1_1SecretSealer.html">SecretSealer</a>.  <a href="#a091da2adb1f78dce5ebed12f3c9667b4">More...</a><br /></td></tr>
<tr class="separator:a091da2adb1f78dce5ebed12f3c9667b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1509a5c117344e66033b2294ec88d87"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classasylo_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classasylo_1_1SgxLocalSecretSealer.html#aa1509a5c117344e66033b2294ec88d87">SetDefaultHeader</a> (SealedSecretHeader *header) const override</td></tr>
<tr class="memdesc:aa1509a5c117344e66033b2294ec88d87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates the default sealed-secret header based on the configuration of the <a class="el" href="classasylo_1_1SecretSealer.html">SecretSealer</a> and writes it to <code>header</code>.  <a href="#aa1509a5c117344e66033b2294ec88d87">More...</a><br /></td></tr>
<tr class="separator:aa1509a5c117344e66033b2294ec88d87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6877b60a0cf7722f2c193406b95c3944"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classasylo_1_1StatusOr.html">StatusOr</a>&lt; size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classasylo_1_1SgxLocalSecretSealer.html#a6877b60a0cf7722f2c193406b95c3944">MaxMessageSize</a> (const SealedSecretHeader &amp;header) const override</td></tr>
<tr class="memdesc:a6877b60a0cf7722f2c193406b95c3944"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the maximum message size (in bytes) that can be sealed according to the cipher-suite configuration recorded in <code>header</code>.  <a href="#a6877b60a0cf7722f2c193406b95c3944">More...</a><br /></td></tr>
<tr class="separator:a6877b60a0cf7722f2c193406b95c3944"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a919092617cfcb0931e85de0a63861975"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classasylo_1_1StatusOr.html">StatusOr</a>&lt; uint64_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classasylo_1_1SgxLocalSecretSealer.html#a919092617cfcb0931e85de0a63861975">MaxSealedMessages</a> (const SealedSecretHeader &amp;header) const override</td></tr>
<tr class="memdesc:a919092617cfcb0931e85de0a63861975"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the maximum number of messages that can safely be sealed according to the cipher-suite configuration recorded in <code>header</code>.  <a href="#a919092617cfcb0931e85de0a63861975">More...</a><br /></td></tr>
<tr class="separator:a919092617cfcb0931e85de0a63861975"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2693aaec3bd0b0af3ccd75f7bc302e3e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classasylo_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classasylo_1_1SgxLocalSecretSealer.html#a2693aaec3bd0b0af3ccd75f7bc302e3e">Seal</a> (const SealedSecretHeader &amp;header, ByteContainerView additional_authenticated_data, ByteContainerView secret, SealedSecret *sealed_secret) override</td></tr>
<tr class="memdesc:a2693aaec3bd0b0af3ccd75f7bc302e3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Seals the input per the header specification.  <a href="#a2693aaec3bd0b0af3ccd75f7bc302e3e">More...</a><br /></td></tr>
<tr class="separator:a2693aaec3bd0b0af3ccd75f7bc302e3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a298b9a250434c685b69467e064b221bc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classasylo_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classasylo_1_1SgxLocalSecretSealer.html#a298b9a250434c685b69467e064b221bc">Unseal</a> (const SealedSecret &amp;sealed_secret, <a class="el" href="namespaceasylo.html#a9aec28a454f8e329b3cd81ef525ea753">CleansingVector</a>&lt; uint8_t &gt; *secret) override</td></tr>
<tr class="memdesc:a298b9a250434c685b69467e064b221bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unseals the <code>sealed_secret</code> and writes it to <code>secret</code>.  <a href="#a298b9a250434c685b69467e064b221bc">More...</a><br /></td></tr>
<tr class="separator:a298b9a250434c685b69467e064b221bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classasylo_1_1SecretSealer"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classasylo_1_1SecretSealer')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classasylo_1_1SecretSealer.html">asylo::SecretSealer</a></td></tr>
<tr class="memitem:a0d3143ead62ab25b5b653ec184f6a077 inherit pub_methods_classasylo_1_1SecretSealer"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classasylo_1_1SecretSealer.html#a0d3143ead62ab25b5b653ec184f6a077">SecretSealer</a> ()=default</td></tr>
<tr class="separator:a0d3143ead62ab25b5b653ec184f6a077 inherit pub_methods_classasylo_1_1SecretSealer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1639d4e4d3f866c38bd31d2709a8777d inherit pub_methods_classasylo_1_1SecretSealer"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classasylo_1_1SecretSealer.html#a1639d4e4d3f866c38bd31d2709a8777d">~SecretSealer</a> ()=default</td></tr>
<tr class="separator:a1639d4e4d3f866c38bd31d2709a8777d inherit pub_methods_classasylo_1_1SecretSealer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb322e705202a11fff2ab10b254bff99 inherit pub_methods_classasylo_1_1SecretSealer"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classasylo_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classasylo_1_1SecretSealer.html#abb322e705202a11fff2ab10b254bff99">Reseal</a> (const SealedSecret &amp;old_sealed_secret, const SealedSecretHeader &amp;new_header, SealedSecret *new_sealed_secret)</td></tr>
<tr class="memdesc:abb322e705202a11fff2ab10b254bff99 inherit pub_methods_classasylo_1_1SecretSealer"><td class="mdescLeft">&#160;</td><td class="mdescRight">Re-seals an already sealed secret to a new header.  <a href="classasylo_1_1SecretSealer.html#abb322e705202a11fff2ab10b254bff99">More...</a><br /></td></tr>
<tr class="separator:abb322e705202a11fff2ab10b254bff99 inherit pub_methods_classasylo_1_1SecretSealer"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a6159d2205a9cf13ca1c38f113116d70b"><td class="memItemLeft" align="right" valign="top">static std::unique_ptr&lt; <a class="el" href="classasylo_1_1SgxLocalSecretSealer.html">SgxLocalSecretSealer</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classasylo_1_1SgxLocalSecretSealer.html#a6159d2205a9cf13ca1c38f113116d70b">CreateMrenclaveSecretSealer</a> ()</td></tr>
<tr class="memdesc:a6159d2205a9cf13ca1c38f113116d70b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates an <a class="el" href="classasylo_1_1SgxLocalSecretSealer.html" title="An implementation of the SecretSealer abstract interface that binds the secrets to the enclave identi...">SgxLocalSecretSealer</a> that seals secrets to the MRENCLAVE part of the enclave code identity.  <a href="#a6159d2205a9cf13ca1c38f113116d70b">More...</a><br /></td></tr>
<tr class="separator:a6159d2205a9cf13ca1c38f113116d70b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfb7e4abdf0f1b170123677d27dbb26e"><td class="memItemLeft" align="right" valign="top">static std::unique_ptr&lt; <a class="el" href="classasylo_1_1SgxLocalSecretSealer.html">SgxLocalSecretSealer</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classasylo_1_1SgxLocalSecretSealer.html#acfb7e4abdf0f1b170123677d27dbb26e">CreateMrsignerSecretSealer</a> ()</td></tr>
<tr class="memdesc:acfb7e4abdf0f1b170123677d27dbb26e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates an <a class="el" href="classasylo_1_1SgxLocalSecretSealer.html" title="An implementation of the SecretSealer abstract interface that binds the secrets to the enclave identi...">SgxLocalSecretSealer</a> that seals secrets to the MRSIGNER part of the enclave identity.  <a href="#acfb7e4abdf0f1b170123677d27dbb26e">More...</a><br /></td></tr>
<tr class="separator:acfb7e4abdf0f1b170123677d27dbb26e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_methods_classasylo_1_1SecretSealer"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_classasylo_1_1SecretSealer')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="classasylo_1_1SecretSealer.html">asylo::SecretSealer</a></td></tr>
<tr class="memitem:a3e3efc3f67478c870f296434f9b2106a inherit pub_static_methods_classasylo_1_1SecretSealer"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classasylo_1_1StatusOr.html">StatusOr</a>&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classasylo_1_1SecretSealer.html#a3e3efc3f67478c870f296434f9b2106a">GenerateSealerId</a> (SealingRootType type, const std::string &amp;name)</td></tr>
<tr class="memdesc:a3e3efc3f67478c870f296434f9b2106a inherit pub_static_methods_classasylo_1_1SecretSealer"><td class="mdescLeft">&#160;</td><td class="mdescRight">Combines the specified sealing root type and sealing root name to form a string.  <a href="classasylo_1_1SecretSealer.html#a3e3efc3f67478c870f296434f9b2106a">More...</a><br /></td></tr>
<tr class="separator:a3e3efc3f67478c870f296434f9b2106a inherit pub_static_methods_classasylo_1_1SecretSealer"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>An implementation of the <a class="el" href="classasylo_1_1SecretSealer.html">SecretSealer</a> abstract interface that binds the secrets to the enclave identity on a local machine. </p>
<p>The secrets sealed by this sealer can only be unsealed on the same machine.</p>
<p>The <a class="el" href="classasylo_1_1SgxLocalSecretSealer.html" title="An implementation of the SecretSealer abstract interface that binds the secrets to the enclave identi...">SgxLocalSecretSealer</a> can be configured to seal secrets either to MRENCLAVE or MRSIGNER. The <a class="el" href="classasylo_1_1SgxLocalSecretSealer.html" title="An implementation of the SecretSealer abstract interface that binds the secrets to the enclave identi...">SgxLocalSecretSealer</a> class provides two factory methods&ndash;one that creates an <a class="el" href="classasylo_1_1SgxLocalSecretSealer.html" title="An implementation of the SecretSealer abstract interface that binds the secrets to the enclave identi...">SgxLocalSecretSealer</a> configured to seal secrets to MRENCLAVE and another that creates an <a class="el" href="classasylo_1_1SgxLocalSecretSealer.html" title="An implementation of the SecretSealer abstract interface that binds the secrets to the enclave identi...">SgxLocalSecretSealer</a> configured to seal secrets to MRSIGNER. In the MRENCLAVE-sealing mode, the default SealedSecretHeader generated by the sealer binds the secrets to the MRENCLAVE portion of the enclave's identity. In the MRSIGNER mode, the default SealedSecretHeader generated by the sealer binds the secrets to the MRSIGNER portion of the enclave's identity. In either mode, the sealed secret is bound to all bits of MISCSELECT, and all security-sensitive bits of ATTRIBUTES, as defined in secs_attributes.h.</p>
<p>Note that the SealedSecretHeader provided to the <a class="el" href="classasylo_1_1SgxLocalSecretSealer.html#a2693aaec3bd0b0af3ccd75f7bc302e3e" title="Seals the input per the header specification. ">Seal()</a> method also controls the cipher suite used for sealing the secret. The default setting of this field (as populated by <a class="el" href="classasylo_1_1SgxLocalSecretSealer.html#aa1509a5c117344e66033b2294ec88d87" title="Generates the default sealed-secret header based on the configuration of the SecretSealer and writes ...">SetDefaultHeader()</a> ) is subject to change. As a result, users must not make any assumptions about the default cipher suite. If they wish to use a specific cipher suite, they must manually verify or override the cipher suite set by the <a class="el" href="classasylo_1_1SgxLocalSecretSealer.html#aa1509a5c117344e66033b2294ec88d87" title="Generates the default sealed-secret header based on the configuration of the SecretSealer and writes ...">SetDefaultHeader()</a> method.</p>
<p>Sample usage for <a class="el" href="classasylo_1_1SgxLocalSecretSealer.html#a2693aaec3bd0b0af3ccd75f7bc302e3e" title="Seals the input per the header specification. ">Seal()</a>: </p><div class="fragment"><div class="line">std::unique_ptr&lt;SgxLocalSecretSealer&gt; sealer = CreateMrsignerSealer();</div><div class="line"></div><div class="line">SealedSecretHeader header;</div><div class="line"><span class="comment">// Fill out the portions of the header that must be set by the client.</span></div><div class="line">header.set_secret_name(<span class="stringliteral">&quot;my name&quot;</span>);</div><div class="line">header.set_secret_version(<span class="stringliteral">&quot;my version&quot;</span>);</div><div class="line">header.set_secret_purpose(<span class="stringliteral">&quot;my purpose&quot;</span>);</div><div class="line"><span class="comment">// secret_handling_policy is a client-specific string, which, for example,</span></div><div class="line">could be a serialized proto.</div><div class="line">string secret_handling_policy = ...</div><div class="line">header.set_secret_handling_policy(secret_handling_policy);</div><div class="line">sealer-&gt;SetDefaultHeader(&amp;header);</div><div class="line"></div><div class="line"><span class="comment">// Override fields in the default header, if desired.</span></div><div class="line">...</div><div class="line"></div><div class="line"><span class="comment">// Generate the secret to be sealed.</span></div><div class="line">std::vector&lt;uint8_t, CleansingAllocator&gt; secret = ...;</div><div class="line"></div><div class="line"><span class="comment">// Generate the additional authenticated data to be tied to the secret.</span></div><div class="line"><span class="keywordtype">string</span> additional_authenticated_data;</div><div class="line">addtional_authenticated_data = ...</div><div class="line"></div><div class="line"><span class="comment">// Seal the secret and the additional authenticated data.</span></div><div class="line">SealedSecret sealed_secret;</div><div class="line">Status status = sealer-&gt;Seal(header, additional_authenticated_data,</div><div class="line">                             secret, &amp;sealed_secret);</div></div><!-- fragment --><p>Sample usage for <a class="el" href="classasylo_1_1SgxLocalSecretSealer.html#a298b9a250434c685b69467e064b221bc" title="Unseals the sealed_secret and writes it to secret. ">Unseal()</a>: </p><div class="fragment"><div class="line">std::unique_ptr&lt;SgxLocalSecretSealer&gt; sealer = CreateMrsignerSealer();</div><div class="line">SealedSecret sealed_secret;</div><div class="line">...</div><div class="line">sealed_secret.ParseFromString(...);</div><div class="line"></div><div class="line">std::vector&lt;uint8_t, CleansingAllocator&lt;uint8_t&gt;&gt; secret;</div><div class="line"><a class="code" href="status__macros_8h.html#a884b0600610551e91852b3bc96c732c4">ASYLO_RETURN_IF_ERROR</a>(sealer-&gt;Unseal(sealed_secret, secret));</div><div class="line"><span class="comment">// secret now holds the unsealed secret. The policy and</span></div><div class="line"><span class="comment">// additional_authenticated_data in the sealed_secret are now</span></div><div class="line"><span class="comment">// authenticated.</span></div></div><!-- fragment --><p>It should be noted that the <a class="el" href="classasylo_1_1SgxLocalSecretSealer.html" title="An implementation of the SecretSealer abstract interface that binds the secrets to the enclave identi...">SgxLocalSecretSealer</a>'s configuration only affects the default header generated by the sealer. Users can override the generated default header. A sealer in either MRENCLAVE or MRSIGNER configuration can unseal secrets that are sealed by a sealer in either configuration. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a0dd8aebad2e1411dc0fffed22d6d0eaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dd8aebad2e1411dc0fffed22d6d0eaf">&#9670;&nbsp;</a></span>SgxLocalSecretSealer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">asylo::SgxLocalSecretSealer::SgxLocalSecretSealer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classasylo_1_1SgxLocalSecretSealer.html">SgxLocalSecretSealer</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ab80397d0b60ff6f1f59fd8fd34a52b75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab80397d0b60ff6f1f59fd8fd34a52b75">&#9670;&nbsp;</a></span>~SgxLocalSecretSealer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual asylo::SgxLocalSecretSealer::~SgxLocalSecretSealer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a6159d2205a9cf13ca1c38f113116d70b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6159d2205a9cf13ca1c38f113116d70b">&#9670;&nbsp;</a></span>CreateMrenclaveSecretSealer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::unique_ptr&lt;<a class="el" href="classasylo_1_1SgxLocalSecretSealer.html">SgxLocalSecretSealer</a>&gt; asylo::SgxLocalSecretSealer::CreateMrenclaveSecretSealer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates an <a class="el" href="classasylo_1_1SgxLocalSecretSealer.html" title="An implementation of the SecretSealer abstract interface that binds the secrets to the enclave identi...">SgxLocalSecretSealer</a> that seals secrets to the MRENCLAVE part of the enclave code identity. </p>
<dl class="section return"><dt>Returns</dt><dd>A smart pointer that owns the created sealer. </dd></dl>

</div>
</div>
<a id="acfb7e4abdf0f1b170123677d27dbb26e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfb7e4abdf0f1b170123677d27dbb26e">&#9670;&nbsp;</a></span>CreateMrsignerSecretSealer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::unique_ptr&lt;<a class="el" href="classasylo_1_1SgxLocalSecretSealer.html">SgxLocalSecretSealer</a>&gt; asylo::SgxLocalSecretSealer::CreateMrsignerSecretSealer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates an <a class="el" href="classasylo_1_1SgxLocalSecretSealer.html" title="An implementation of the SecretSealer abstract interface that binds the secrets to the enclave identi...">SgxLocalSecretSealer</a> that seals secrets to the MRSIGNER part of the enclave identity. </p>
<dl class="section return"><dt>Returns</dt><dd>A smart pointer that owns the created sealer. </dd></dl>

</div>
</div>
<a id="a6877b60a0cf7722f2c193406b95c3944"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6877b60a0cf7722f2c193406b95c3944">&#9670;&nbsp;</a></span>MaxMessageSize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classasylo_1_1StatusOr.html">StatusOr</a>&lt;size_t&gt; asylo::SgxLocalSecretSealer::MaxMessageSize </td>
          <td>(</td>
          <td class="paramtype">const SealedSecretHeader &amp;&#160;</td>
          <td class="paramname"><em>header</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the maximum message size (in bytes) that can be sealed according to the cipher-suite configuration recorded in <code>header</code>. </p>
<p>The user is expected to call this before calling <a class="el" href="classasylo_1_1SgxLocalSecretSealer.html#a2693aaec3bd0b0af3ccd75f7bc302e3e" title="Seals the input per the header specification. ">Seal()</a> to ensure that they have chunked their messages correctly. The maximum message sizes of supported cipher-suites are as follows:</p><ul>
<li>AES-GCM-SIV supports a maximum message size of 32 MiB</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">header</td><td>The associated header to determine the maximum message size. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The maximum message size that can be encrypted based on the cipher-suite configuration in header, or a non-OK status if the </dd></dl>

<p>Implements <a class="el" href="classasylo_1_1SecretSealer.html#af20737a4d77b6bc8721cfcca1eb3285f">asylo::SecretSealer</a>.</p>

</div>
</div>
<a id="a919092617cfcb0931e85de0a63861975"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a919092617cfcb0931e85de0a63861975">&#9670;&nbsp;</a></span>MaxSealedMessages()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classasylo_1_1StatusOr.html">StatusOr</a>&lt;uint64_t&gt; asylo::SgxLocalSecretSealer::MaxSealedMessages </td>
          <td>(</td>
          <td class="paramtype">const SealedSecretHeader &amp;&#160;</td>
          <td class="paramname"><em>header</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the maximum number of messages that can safely be sealed according to the cipher-suite configuration recorded in <code>header</code>. </p>
<p>The user is responsible for following these guidelines. The secret sealer will not check the number of secrets sealed. The maximum number of sealed messages of supported cipher-suites are as follows:</p><ul>
<li>AES-GCM-SIV can safely seal 2 ^ 48 messages</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">header</td><td>The associated header to determine the maximum number of sealed messages. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The maximum number of messages that can be sealed based on the cipher-suite configuration in header, or a non-OK status if the cipher-suite configuration is not supported. </dd></dl>

<p>Implements <a class="el" href="classasylo_1_1SecretSealer.html#a007984f00fae5ad11876a05ee0174901">asylo::SecretSealer</a>.</p>

</div>
</div>
<a id="ae9ef3bdad50e42e6ae606df39bc0b9f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9ef3bdad50e42e6ae606df39bc0b9f6">&#9670;&nbsp;</a></span>operator=()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classasylo_1_1SgxLocalSecretSealer.html">SgxLocalSecretSealer</a>&amp; asylo::SgxLocalSecretSealer::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classasylo_1_1SgxLocalSecretSealer.html">SgxLocalSecretSealer</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a091da2adb1f78dce5ebed12f3c9667b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a091da2adb1f78dce5ebed12f3c9667b4">&#9670;&nbsp;</a></span>RootAcl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;EnclaveIdentityExpectation&gt; asylo::SgxLocalSecretSealer::RootAcl </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the sealing root ACL of this <a class="el" href="classasylo_1_1SecretSealer.html">SecretSealer</a>. </p>
<dl class="section return"><dt>Returns</dt><dd>The sealing root ACL of this object. </dd></dl>

<p>Implements <a class="el" href="classasylo_1_1SecretSealer.html#a0c8f2132442f87e79e24904a66619cb6">asylo::SecretSealer</a>.</p>

</div>
</div>
<a id="a4dcb1ac9d3c53e53c5dfcd0204fffde2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4dcb1ac9d3c53e53c5dfcd0204fffde2">&#9670;&nbsp;</a></span>RootName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string asylo::SgxLocalSecretSealer::RootName </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the sealing root name of this <a class="el" href="classasylo_1_1SecretSealer.html">SecretSealer</a>. </p>
<dl class="section return"><dt>Returns</dt><dd>The sealing root name of this class. </dd></dl>

<p>Implements <a class="el" href="classasylo_1_1SecretSealer.html#a08dcfd32b295db7eb5fdc53ac177d2f1">asylo::SecretSealer</a>.</p>

</div>
</div>
<a id="a2baa820e5057547420bbdab9ff047888"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2baa820e5057547420bbdab9ff047888">&#9670;&nbsp;</a></span>RootType()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SealingRootType asylo::SgxLocalSecretSealer::RootType </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the sealing root type of this <a class="el" href="classasylo_1_1SecretSealer.html">SecretSealer</a>. </p>
<dl class="section return"><dt>Returns</dt><dd>The sealing root type of this class. </dd></dl>

<p>Implements <a class="el" href="classasylo_1_1SecretSealer.html#a698599705c67ea2557edfa03efedff29">asylo::SecretSealer</a>.</p>

</div>
</div>
<a id="a2693aaec3bd0b0af3ccd75f7bc302e3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2693aaec3bd0b0af3ccd75f7bc302e3e">&#9670;&nbsp;</a></span>Seal()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classasylo_1_1Status.html">Status</a> asylo::SgxLocalSecretSealer::Seal </td>
          <td>(</td>
          <td class="paramtype">const SealedSecretHeader &amp;&#160;</td>
          <td class="paramname"><em>header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ByteContainerView&#160;</td>
          <td class="paramname"><em>additional_authenticated_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ByteContainerView&#160;</td>
          <td class="paramname"><em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SealedSecret *&#160;</td>
          <td class="paramname"><em>sealed_secret</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Seals the input per the header specification. </p>
<p>The <code>header</code> must have its <code>secret_name</code>, <code>secret_version</code> and <code>secret_purpose</code> fields populated. If any of the remaining fields in the <code>header</code> are populated, then they must be compatible with the underlying sealing root.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">header</td><td>The metadata to guide the sealing. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">additional_authenticated_data</td><td>Unencrypted data that is bundled with the sealed secret. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">secret</td><td>The data to encrypt and seal. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sealed_secret</td><td>The output sealed secret. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A non-OK status if sealing fails. </dd></dl>

<p>Implements <a class="el" href="classasylo_1_1SecretSealer.html#a34b4c3ac7b9b857949bd4ab2c6c23559">asylo::SecretSealer</a>.</p>

</div>
</div>
<a id="aa1509a5c117344e66033b2294ec88d87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1509a5c117344e66033b2294ec88d87">&#9670;&nbsp;</a></span>SetDefaultHeader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classasylo_1_1Status.html">Status</a> asylo::SgxLocalSecretSealer::SetDefaultHeader </td>
          <td>(</td>
          <td class="paramtype">SealedSecretHeader *&#160;</td>
          <td class="paramname"><em>header</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generates the default sealed-secret header based on the configuration of the <a class="el" href="classasylo_1_1SecretSealer.html">SecretSealer</a> and writes it to <code>header</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">header</td><td>The destination for the default SealedSecretHeader value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A non-OK status if a default cannot be set. </dd></dl>

<p>Implements <a class="el" href="classasylo_1_1SecretSealer.html#af584b663c92f63fff7cfd3bc3eec3cff">asylo::SecretSealer</a>.</p>

</div>
</div>
<a id="a298b9a250434c685b69467e064b221bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a298b9a250434c685b69467e064b221bc">&#9670;&nbsp;</a></span>Unseal()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classasylo_1_1Status.html">Status</a> asylo::SgxLocalSecretSealer::Unseal </td>
          <td>(</td>
          <td class="paramtype">const SealedSecret &amp;&#160;</td>
          <td class="paramname"><em>sealed_secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceasylo.html#a9aec28a454f8e329b3cd81ef525ea753">CleansingVector</a>&lt; uint8_t &gt; *&#160;</td>
          <td class="paramname"><em>secret</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Unseals the <code>sealed_secret</code> and writes it to <code>secret</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">sealed_secret</td><td>The input secret to unseal. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">secret</td><td>The destination for the unsealed secret. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A non-OK <a class="el" href="classasylo_1_1Status.html" title="Status contains information about an error. ">Status</a> if unsealing fails. </dd></dl>

<p>Implements <a class="el" href="classasylo_1_1SecretSealer.html#ae0bcb8d3990b493f9251d5797a8dbe19">asylo::SecretSealer</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>asylo/identity/sealing/sgx/<a class="el" href="sgx__local__secret__sealer_8h_source.html">sgx_local_secret_sealer.h</a></li>
</ul>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/>
</body>
</html>
